<link rel="import" href="../google-spreadsheet-json/google-spreadsheet-json.html">

<polymer-element name="rw-survey-rating" attributes="name index entries">
  <template>
    <h4>{{name}}</h4>

    <template repeat="{{rating in ratings}}">
      <div class="rating">{{rating.name}}: {{rating.value}}</div>
    </template>
  </template>
 <script>
    Polymer('rw-survey-rating', {
      entriesChanged: function() {
        var ratings = {};
        _.each(this.entries, function(entry) {
          var value = entry.ratings[this.index];
          ratings[value] = ratings[value] ? ratings[value] + 1 : 1;
        }, this);

        this.ratings = _.map(ratings, function(value, key) {
          return {
            name: key,
            value: value
          }
        });
      }
    });
  </script>
</polymer-element>